<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Curricular Marketing</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f6f1eb;
      color: #4b3621;
      margin: 0;
      padding: 20px;
      position: relative;
    }
    h1, h2, h3 {
      text-align: center;
      color: #5e473a;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    .semestre {
      background: #fff8f0;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 8px rgba(100, 70, 50, 0.1);
    }
    .materia {
      padding: 10px;
      margin-bottom: 8px;
      background-color: #f1e4d1;
      border-left: 5px solid #b08b66;
      border-radius: 6px;
      cursor: pointer;
      position: relative;
      transition: background-color 0.3s;
    }
    .materia.aprobada {
      background-color: #d2c1aa;
      border-left-color: #927b5d;
      text-decoration: line-through;
    }
    .materia.bloqueada {
      background-color: #e4d3c4;
      border-left-color: #a1866f;
      cursor: not-allowed;
    }
    .materia.bloqueada::after {
      content: attr(data-tooltip);
      position: absolute;
      top: 50%;
      left: 105%;
      transform: translateY(-50%);
      background: #4b3621;
      color: #fff;
      padding: 5px 8px;
      border-radius: 4px;
      font-size: 12px;
      white-space: nowrap;
      display: none;
      z-index: 10;
    }
    .materia.bloqueada:hover::after {
      display: block;
    }
    .rose {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 60px;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Marketing</h1>
  <div id="malla"></div>
  <img class="rose" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/13/Rose_pink.svg/1024px-Rose_pink.svg.png" alt="Rosa palo de rosa">
  <script>
    const materias = {
      // contenido de materias aquí (no se repite en esta vista por brevedad)
    };

    const aprobadas = JSON.parse(localStorage.getItem('materiasAprobadas') || '[]');

    function guardarAprobadas() {
      localStorage.setItem('materiasAprobadas', JSON.stringify(aprobadas));
    }

    function renderMalla() {
      const container = document.getElementById("malla");
      container.innerHTML = '';
      for (const [año, semestres] of Object.entries(materias)) {
        const titulo = document.createElement("h2");
        titulo.textContent = año;
        container.appendChild(titulo);
        const grid = document.createElement("div");
        grid.className = "grid";

        for (const [semestre, lista] of Object.entries(semestres)) {
          const semDiv = document.createElement("div");
          semDiv.className = "semestre";
          semDiv.innerHTML = `<h3>${semestre}</h3>`;

          for (const materia of lista) {
            const div = document.createElement("div");
            div.className = "materia";
            div.textContent = `${materia.nombre} \n${materia.creditos} créditos`;

            const bloqueada = materia.requisitos?.some(req => !aprobadas.includes(req));
            if (bloqueada) {
              div.classList.add("bloqueada");
              div.setAttribute("data-tooltip", "Faltan: " + materia.requisitos.filter(req => !aprobadas.includes(req)).join(", "));
            } else {
              div.addEventListener("click", () => {
                if (aprobadas.includes(materia.nombre)) {
                  aprobadas.splice(aprobadas.indexOf(materia.nombre), 1);
                } else {
                  aprobadas.push(materia.nombre);
                }
                guardarAprobadas();
                renderMalla();
              });
              if (aprobadas.includes(materia.nombre)) {
                div.classList.add("aprobada");
              }
            }
            semDiv.appendChild(div);
          }
          grid.appendChild(semDiv);
        }
        container.appendChild(grid);
      }
    }

    renderMalla();
  </script>
</body>
</html>
